/*
 * Car *c1 = new Car();
 Car *c2 = new Car();

 char *targa = (char*) malloc(sizeof("ZA-044-ZB"));
 strcpy(targa, "ZA-044-ZB");
 //Car* c3 = new Car(targa);
 Car *c4 = new Car(targa, 1350, 170);

 cout << "Targa auto c1: " << c1->getTarga() << endl;
 c1->setTarga("AZ-655-CR");
 cout << "Targa auto c1: " << c1->getTarga() << endl;

 Car *c5(c4);
 cout << "Targa auto c5: " << c1->getTarga() << endl;

 Car *c6(c5);
 cout << "Targa auto c6: " << c1->getTarga() << endl;
 */

/*
 vector<int> myStandards = { 180, 260, 420 };
 Ecar *ec1 = new Ecar(myStandards);
 cout << "Targa auto elettrica ec1: " << ec1->getTarga() << endl;
 try {
 ec1->setTarga("EL-101-LEEEEEEEEE");
 } catch (int x) {
 cout << "Formato targa errato! Cannot update" << endl;
 }
 cout << "Targa auto elettrica ec1: " << ec1->getTarga() << endl;
 ec1->showInfo();

 FFcar *ffc1 = new FFcar("ZA-044-ZB", 1200, 149, 50, 4.5, 5.5, 8.9);
 cout << "Targa auto tradizionale ffc1: " << ffc1->getTarga() << endl;
 try {
 ffc1->setTarga("EL-101-LE");
 } catch (int x) {
 cout << "Formato targa errato! Cannot update" << endl;
 }
 cout << "Targa auto tradizionale ffc1: " << ffc1->getTarga() << endl;
 ffc1->showInfo();

 TaxCalc<float> tc(5.1);
 cout << tc.calcoloBollo(ffc1) << endl;

 //-------------------------------------------------------------------

 Hcar *hc1 = new Hcar("ZA-044-ZB", 1200, 149, 50, 4.5, 5.5, 8.9,
 myStandards);

 hc1->showInfo();

 cout << "\n\nTarga auto ibrida hc1: " << hc1->getTarga() << endl;
 try {
 hc1->setTarga("EL-101-LE");
 } catch (int x) {
 cout << "Formato targa errato! Cannot update" << endl;
 }
 cout << "Targa auto ibrida hc1: " << hc1->getTarga() << endl;

 hc1->showInfo();
 */
 
 
 
 
 
 
 
 
 /*
 * Garage.cpp
 *
 * Implementazione della class Garage: sfrutto il concetto di
 * Smart Pointers nella forma unique_ptr<>
 *
 *  Created on: 16 ago 2021
 *      Author: Luca Ghislotti
 */

#include <iostream>
using namespace std;
#include <cstring>
#include <string>
#include <memory>
#include "Garage.h"
#include "Car.h"
#include "FFcar.h"
#include "Hcar.h"
#include "Ecar.h"
#include <typeinfo>

Garage::Garage() {
}

unique_ptr<Car> Garage::newAuto() {
	string targa;
	char *targa_ptr = (char*) malloc(sizeof(char) * targa.length());
	int peso, potenza;

	cout << "Targa: ";
	cin >> targa;
	cout << "Peso: ";
	cin >> peso;
	cout << "Potenza: ";
	cin >> potenza;

	int carType;
	cout << "Tipo auto: ";
	cin >> carType;

	strcpy(targa_ptr, targa.data());

	switch (carType) {
	// FFcar
	case 0: {
		short fuelCap;
		double urbano, combi, extra;

		cout << "Capacità serbatoio: ";
		cin >> fuelCap;
		cout << "Consumo urbano: ";
		cin >> urbano;
		cout << "Consumo combinato: ";
		cin >> combi;
		cout << "Consumo extra-urbano: ";
		cin >> extra;

		unique_ptr<Car> veicoloFF(
				new FFcar(targa_ptr, peso, potenza, fuelCap, urbano, combi,
						extra));
		flotta.push_back(move(veicoloFF));
		cout << "Creata auto tradizionale" << endl;
		break;
	}

		// Ecar
	case 1: {
		unique_ptr<Car> veicoloE(new Ecar(targa_ptr, peso, potenza));
		flotta.push_back(move(veicoloE));
		cout << "Creata auto elettrica" << endl;
		break;
	}

		// Hcar
	case 2: {
		short fuelCap;
		double urbano, combi, extra;
		int s1, s2, s3;

		cout << "Capacità serbatoio: ";
		cin >> fuelCap;
		cout << "Consumo urbano: ";
		cin >> urbano;
		cout << "Consumo combinato: ";
		cin >> combi;
		cout << "Consumo extra-urbano: ";
		cin >> extra;
		cout << "Standard 1: ";
		cin >> s1;
		cout << "Standard 2: ";
		cin >> s2;
		cout << "Standard 3: ";
		cin >> s3;

		vector<int> standards = { s1, s2, s3 };

		unique_ptr<Car> veicoloH(
				new Hcar(targa_ptr, peso, potenza, fuelCap, urbano, combi,
						extra, standards));
		flotta.push_back(move(veicoloH));
		cout << "Creata auto ibrida" << endl;
		break;
	}

	default:
		/*
		 * Viene sollevata eccezione se utente non inserisce il corretto
		 * simbolo
		 */
		throw 403; // Error code
	}

	return move(flotta.back());
}

bool Garage::isElectric(Car *c) {
	if (c->getClassName() == "E" || c->getClassName() == "H")
		return true;
	else
		return false;
}

void Garage::stampaInfoAuto(Car *c) {
	c->showInfo();
}

void stampaFlotta() {
}